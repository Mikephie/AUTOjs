<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>脚本转换测试</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        textarea { width: 100%; height: 200px; margin-bottom: 10px; }
        button { padding: 10px 20px; margin-right: 10px; }
    </style>
</head>
<body>
    <h1>脚本转换测试</h1>
    
    <h2>输入脚本内容</h2>
    <textarea id="input" placeholder="粘贴QuantumultX脚本内容到这里..."></textarea>
    
    <div>
        <button onclick="convertToLoon()">转换为Loon格式</button>
        <button onclick="convertToSurge()">转换为Surge格式</button>
        <button onclick="clearAll()">清空</button>
    </div>
    
    <h2>转换结果</h2>
    <textarea id="output" readonly></textarea>
    
    <script>
        function convertToLoon() {
            const input = document.getElementById('input').value;
            const output = document.getElementById('output');
            
            if (!input.trim()) {
                alert('请输入脚本内容');
                return;
            }
            
            // 简单转换逻辑
            let result = input;
            
            // 1. 处理主机名
            result = result.replace(/hostname\s*=\s*(.*)/, 'hostname = $1');
            
            // 2. 处理脚本规则
            result = result.replace(/^(https?:\/\/[^\s]+)\s+url\s+script-([a-z-]+)\s+([^\s]+)(.*)$/gm, 
                                   'http-$2 $1 script-path=$3$4');
            
            // 3. 处理reject规则
            result = result.replace(/^(https?:\/\/[^\s]+)\s+url\s+reject(-.*)?$/gm, 
                                   'http-request $1 reject$2');
            
            output.value = result;
        }
        
        function convertToSurge() {
            const input = document.getElementById('input').value;
            const output = document.getElementById('output');
            
            if (!input.trim()) {
                alert('请输入脚本内容');
                return;
            }
            
            // 简单转换逻辑
            let result = input;
            
            // 1. 处理主机名
            result = result.replace(/hostname\s*=\s*(.*)/, 'hostname = %APPEND% $1');
            
            // 2. 处理脚本规则
            result = result.replace(/^(https?:\/\/[^\s]+)\s+url\s+script-([a-z-]+)\s+([^\s]+)(.*)$/gm, 
                                   '$2 $1 script-path=$3$4');
            
            // 3. 处理reject规则
            result = result.replace(/^(https?:\/\/[^\s]+)\s+url\s+reject(-.*)?$/gm, 
                                   'URL-REGEX $1 reject$2');
            
            output.value = result;
        }
        
        function clearAll() {
            document.getElementById('input').value = '';
            document.getElementById('output').value = '';
        }
    </script>
</body>
</html>
